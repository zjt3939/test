<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>layuiTree</title>
    <link rel="stylesheet" type="" href="./layui/css/layui.css">
    <style>
        ul#demo {
            font-size: 1.2em;
        }
    </style>
</head>

<body>
    <ul id="demo"></ul>
</body>
<script src="./layui/layui.js"></script>
<script>
    var nodeData;
    function add(id){
        alert(id);
    }
    layui.use(['tree', 'layer'], function () {
        var layer = layui.layer
            , $ = layui.jquery;
        $(function () {
            $.ajax({
                type: 'GET',
                url: 'traverseArray.php',
                dataType: 'json',
                success: function (re, status, xhr) {
                    var jsondata = eval(re);
                    $.each(jsondata, function (key, value) {
                        value.name += value.id + '<button class="layui-btn layui-btn-normal class="layui-btn layui-btn-mini" style="margin-left:30px;" onclick="add('+value.id+')">添加<button>';
                        getTree(key, value);
                        function getTree(key, value) {
                            if (typeof (value.children) != 'undefined' && value.children instanceof Array) {
                                $.each(value.children, function (key, value) {
                                    value.name += value.id +  '<button class="layui-btn layui-btn-normal class="layui-btn layui-btn-mini" style="margin-left:30px;" onclick="add('+value.id+')">添加<button>';
                                    getTree(key, value);
                                });
                            }else{
                                return false;
                            }
                        }

                    }); 
                    nodeData = jsondata;
                    // debugger;
                    console.log(nodeData);
                    // nodeData = JSON.stringify(jsondata);
                    // console.log(nodeData);
                    var tree =layui.tree({
                        elem: '#demo' //指定元素
                        // , target: '_blank' //是否新选项卡打开（比如节点返回href才有效）
                        , nodes: nodeData
                        // ,click: function(item){ //点击节点回调
                        //   layer.msg('当前节名称：'+ item.name + '<br>全部参数：'+ JSON.stringify(item));
                        //   console.log(item);
                        // }

                    });
                    

                }
            });
        });
        // debugger;
        // console.log(nodeData);
        // var tree =layui.tree({
        //     elem: '#demo' //指定元素
        //     // , target: '_blank' //是否新选项卡打开（比如节点返回href才有效）
        //     , nodes: nodeData
        //     , drag: true
        //     , skin: 'as'

        //     // ,click: function(item){ //点击节点回调
        //     //   layer.msg('当前节名称：'+ item.name + '<br>全部参数：'+ JSON.stringify(item));
        //     //   console.log(item);
        //     // }

        // });

    });

</script>

</html>